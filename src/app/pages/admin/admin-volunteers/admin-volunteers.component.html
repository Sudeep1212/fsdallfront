<div class="admin-volunteers-module">
  <!-- Module Header -->
  <div class="module-header">
    <h1>Volunteers Module</h1>
  </div>

  <!-- Stats Container -->
  <div class="stats-container">
    <div class="stats-content">
      <div class="stat-item">
        <div class="stat-label">Total Volunteers</div>
        <div class="stat-value">{{ volunteers.length }}</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">Active Records</div>
        <div class="stat-value">{{ filteredVolunteers.length }}</div>
      </div>
    </div>
  </div>

  <!-- Search and Create Section -->
  <div class="actions-bar">
    <div class="search-container">
      <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        (input)="filterVolunteers()" 
        placeholder="Search by name, role, club, department, venue, or event..."
        class="search-input"
      />
      <button *ngIf="searchTerm" class="clear-btn" (click)="clearSearch()">✕</button>
    </div>
    <button class="create-btn" (click)="openCreateModal()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
      Create Volunteer
    </button>
  </div>

  <!-- Volunteers Table -->
  <div class="table-container">
    <table class="volunteers-table">
      <thead>
        <tr>
          <th>Sr. No.</th>
          <th>Name</th>
          <th>Role</th>
          <th>Contact</th>
          <th>Assigned</th>
          <th>Club</th>
          <th>Department</th>
          <th>Venue</th>
          <th>Event</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let volunteer of filteredVolunteers; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ volunteer.name }}</td>
          <td>{{ volunteer.role }}</td>
          <td>{{ volunteer.contact }}</td>
          <td>
            <span class="status-badge" [class.assigned]="volunteer.isAssigned" [class.unassigned]="!volunteer.isAssigned">
              {{ volunteer.isAssigned ? 'Assigned' : 'Available' }}
            </span>
          </td>
          <td>{{ volunteer.clubName || 'N/A' }}</td>
          <td>{{ volunteer.departmentName || 'N/A' }}</td>
          <td>{{ volunteer.venueName || 'N/A' }}</td>
          <td>{{ volunteer.eventName || 'N/A' }}</td>
          <td>
            <button class="delete-btn" (click)="openDeleteModal(volunteer.volunteerId!)" title="Delete Volunteer">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <polyline points="3 6 5 6 21 6" stroke-width="2"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke-width="2"/>
              </svg>
            </button>
          </td>
        </tr>
        <tr *ngIf="filteredVolunteers.length === 0">
          <td colspan="10" style="text-align: center; padding: 40px;">
            {{ searchTerm ? 'No volunteers found matching your search' : 'No volunteers available' }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Create Volunteer Modal -->
  <!-- Create Modal -->
<div class="modal-overlay" *ngIf="showCreateModal" (click)="closeCreateModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Create New Volunteer</h3>
      <button class="close-btn" (click)="closeCreateModal()">✕</button>
    </div>
    <form class="modal-form" [formGroup]="volunteerForm" (ngSubmit)="onSubmit()">
        <div class="form-grid">
          <div class="form-group">
            <label for="name">Volunteer Name *</label>
            <input 
              type="text" 
              id="name" 
              formControlName="name" 
              placeholder="Enter volunteer name"
              [class.error]="volunteerForm.get('name')?.invalid && volunteerForm.get('name')?.touched"
            />
            <span class="error-msg" *ngIf="volunteerForm.get('name')?.invalid && volunteerForm.get('name')?.touched">
              Name must be at least 3 characters
            </span>
          </div>

          <div class="form-group">
            <label for="role">Role *</label>
            <input 
              type="text" 
              id="role" 
              formControlName="role" 
              placeholder="Enter role (e.g., Coordinator, Helper)"
              [class.error]="volunteerForm.get('role')?.invalid && volunteerForm.get('role')?.touched"
            />
            <span class="error-msg" *ngIf="volunteerForm.get('role')?.invalid && volunteerForm.get('role')?.touched">
              Role must be at least 3 characters
            </span>
          </div>

          <div class="form-group">
            <label for="contact">Contact *</label>
            <input 
              type="text" 
              id="contact" 
              formControlName="contact" 
              placeholder="10-digit mobile number"
              maxlength="10"
              [class.error]="volunteerForm.get('contact')?.invalid && volunteerForm.get('contact')?.touched"
            />
            <span class="error-msg" *ngIf="volunteerForm.get('contact')?.invalid && volunteerForm.get('contact')?.touched">
              Contact must be exactly 10 digits
            </span>
          </div>

          <div class="form-group">
            <label for="isAssigned">Assignment Status *</label>
            <select id="isAssigned" formControlName="isAssigned">
              <option [value]="false">Available</option>
              <option [value]="true">Assigned</option>
            </select>
          </div>

          <div class="form-group">
            <label for="club_id">Club (Optional)</label>
            <select id="club_id" formControlName="club_id">
              <option [value]="null">Select a club</option>
              <option *ngFor="let club of clubs" [value]="club.club_id">{{ club.name }}</option>
            </select>
          </div>

          <div class="form-group">
            <label for="department_id">Department (Optional)</label>
            <select id="department_id" formControlName="department_id">
              <option [value]="null">Select a department</option>
              <option *ngFor="let dept of departments" [value]="dept.departmentId">{{ dept.name }}</option>
            </select>
          </div>

          <div class="form-group">
            <label for="venue_id">Venue (Optional)</label>
            <select id="venue_id" formControlName="venue_id">
              <option [value]="null">Select a venue</option>
              <option *ngFor="let venue of venues" [value]="venue.venue_id">{{ venue.name }}</option>
            </select>
          </div>

          <div class="form-group">
            <label for="event_id">Event (Optional)</label>
            <select id="event_id" formControlName="event_id">
              <option [value]="null">Select an event</option>
              <option *ngFor="let event of events" [value]="event.event_id">{{ event.name }}</option>
            </select>
          </div>
        </div>

        <div class="error-message" *ngIf="error">{{ error }}</div>

        <div class="modal-actions">
          <button type="button" class="cancel-btn" (click)="closeCreateModal()">Cancel</button>
          <button type="submit" class="submit-btn" [disabled]="volunteerForm.invalid || loading">
            {{ loading ? 'Creating...' : 'Create Volunteer' }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal-overlay" *ngIf="showDeleteModal" (click)="closeDeleteModal()">
    <div class="modal-content modal-small" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Confirm Deletion</h3>
        <button class="close-btn" (click)="closeDeleteModal()">✕</button>
      </div>

      <div class="modal-body">
        <p>Are you sure you want to delete this volunteer?</p>
        <p class="warning-text">This action cannot be undone.</p>
      </div>

      <div class="error-message" *ngIf="error">{{ error }}</div>

      <div class="modal-actions">
        <button class="cancel-btn" (click)="closeDeleteModal()" [disabled]="loading">Cancel</button>
        <button class="delete-confirm-btn" (click)="confirmDelete()" [disabled]="loading">
          {{ loading ? 'Deleting...' : 'Delete' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Success Toast -->
  <div class="toast toast-success" *ngIf="showSuccessToast">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <polyline points="20 6 9 17 4 12"></polyline>
    </svg>
    <span>{{ toastMessage }}</span>
  </div>

  <!-- Error Toast -->
  <div class="toast toast-error" *ngIf="showErrorToast">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="15" y1="9" x2="9" y2="15"></line>
      <line x1="9" y1="9" x2="15" y2="15"></line>
    </svg>
    <span>{{ toastMessage }}</span>
  </div>
</div>
